"use strict";function docReady(e){"complete"===document.readyState||"interactive"===document.readyState?setTimeout(e,1):document.addEventListener("DOMContentLoaded",e)}docReady(function(){let e=document.querySelectorAll(".castos-player");e.forEach(function(t){let r=t.dataset.player_id,n=window["ssp_castos_player_"+r],i=t.dataset.episode,e=t.querySelector(".ssp-playback"),s,a=t.querySelector(".play-btn"),o=t.querySelector(".pause-btn"),c=t.querySelector(".player__artwork"),l=t.querySelector(".ssp-duration"),d=t.querySelector(".ssp-timer"),u=t.querySelector(".ssp-progress"),p=t.querySelector(".progress__filled"),f=e.querySelectorAll("[data-skip]"),y=t.querySelector(".player-btn__volume"),v=t.querySelector(".player-btn__speed"),m=t.querySelector(".ssp-loader"),L=t.querySelector(".playlist__items"),_=t.querySelector(".player__podcast-title"),h=t.querySelector(".player__episode-title"),E=t.querySelector(".playlist__wrapper"),S=!!E,q,b;function k(e){return(""+(e+100)).substring(1)}function g(e){var t=Math.floor(e/3600);e%=3600;let i=Math.floor(e/60),s=Math.floor(e%60),r=0;return r=0<t?k(t)+" : "+k(i)+" : "+k(s):k(i)+":"+k(s),r}function T(){clearTimeout(b),b=setTimeout(function(){s.paused?(s.play(),A(),o.focus()):(M(),a.focus())},100)}function M(){s.pause(),A()}function A(){s.paused?(o.classList.add("hide"),a.classList.remove("hide"),a.setAttribute("aria-pressed","false"),o.setAttribute("aria-pressed","true")):(o.classList.remove("hide"),a.classList.add("hide"),a.setAttribute("aria-pressed","true"),o.setAttribute("aria-pressed","false"))}function w(){l.innerHTML=g(s.duration),l.setAttribute("datetime",function(e){var t=Math.floor(e/3600),i=Math.floor(e%3600/60),e=Math.floor(e%60);let s="PT";0<t&&(s+=t+"H");(0<i||0<t)&&(s+=i+"M");return s+=e+"S",s}(s.duration)),u.setAttribute("aria-valuemax",Math.floor(s.duration))}function x(){var e=s.currentTime/s.duration*100;p.style.flexBasis=e+"%",d.innerHTML=g(s.currentTime),u.setAttribute("aria-valuenow",Math.floor(s.currentTime))}function C(e){s.currentTime=e.offsetX/u.offsetWidth*s.duration}function H(){s.currentTime+=parseFloat(this.dataset.skip)}function F(e){(e<.4||2<e)&&(e=1),v.setAttribute("data-speed",e),v.innerHTML=e+"x",s.playbackRate=e}function R(){m.classList.remove("hide")}function D(){m.classList.add("hide")}function O(){D(),s=t.querySelector(".clip-"+i),s.addEventListener("play",A),s.addEventListener("pause",A),s.addEventListener("playing",A),s.addEventListener("playing",w),s.addEventListener("timeupdate",x),s.onended=function(){o.classList.add("hide"),a.classList.remove("hide");let e=t.querySelector(".playlist__item.active");if(e){e.classList.remove("active");let t=e.nextElementSibling;if(t){let e=document.createEvent("HTMLEvents");e.initEvent("click",!0,!1),t.dispatchEvent(e)}}},s.addEventListener("waiting",R),s.addEventListener("canplay",D)}a.addEventListener("click",T),o.addEventListener("click",T),c.addEventListener("click",T),v.addEventListener("click",function(){F(this.dataset.speed<2?(parseFloat(this.dataset.speed)+.2).toFixed(1):.4)}),f.forEach(function(e){return e.addEventListener("click",H)}),y.addEventListener("click",function(){1===s.volume?(s.volume=0,y.classList.add("off")):(s.volume=1,y.classList.remove("off"))});let K=!1;u.addEventListener("click",C),u.addEventListener("mousemove",function(e){return K&&C(e)}),u.addEventListener("mousedown",function(){return K=!0}),u.addEventListener("mouseup",function(){return K=!1});let P=t.querySelector(".subscribe-btn"),j=t.querySelector(".player-panels .subscribe"),J=t.querySelector(".player-panels .subscribe .close-btn"),N=t.querySelector(".share-btn"),X=t.querySelector(".player-panels .share"),B=t.querySelector(".player-panels .share .close-btn"),G=t.querySelector(".input-link"),U=t.querySelector(".copy-link"),W=t.querySelector(".input-embed"),z=t.querySelector(".copy-embed"),I=t.querySelector(".input-rss"),Q=t.querySelector(".copy-rss");function V(e){e.classList.contains("open")?e.classList.remove("open"):(e.classList.add("open"),e.focus())}function Y(e){e.select(),document.execCommand("Copy")}function Z(){var e,t;this.dataset.episode!==i&&(L.querySelectorAll(".playlist__item").forEach(function(e){e.classList.remove("active")}),this.classList.add("active"),e=this.querySelector(".playlist__episode-title"),t=this.querySelector(".playlist__item__cover img"),_.textContent=e.dataset.podcast,h.textContent=e.textContent,c.querySelector("img").src=t.src,M(),i=this.dataset.episode,O(),setTimeout(function(){T()},500))}function $(){function s(){q.style.display="none",E.dataset.processing=""}E.dataset.processing||q.scrollHeight-q.scrollTop!==q.clientHeight||function(){q.style.display="block",E.dataset.processing="1";let e=new XMLHttpRequest,t=new URL(n.ajax_url);var i={action:"get_playlist_items",atts:JSON.stringify(n.atts),page:++E.dataset.page,player_id:r,nonce:n.nonce};Object.keys(i).forEach(function(e){t.searchParams.set(e,i[e])}),e.open("GET",t.toString(),!0),e.onload=function(){if(200===this.status){let e=JSON.parse(this.response);0<e.data.length?e.data.forEach(function(e){let t=function(e){let t=document.createElement("div");return t.innerHTML='<li class="playlist__item" data-episode="'+e.episode_id+'"><div class="playlist__item__cover"><img src="'+e.album_art.src+'" title="'+e.title+'" alt="'+e.title+'" /></div><div class="playlist__item__details"><h2 class="playlist__episode-title" data-podcast="'+e.podcast_title+'">'+e.title+"</h2><p>"+e.date+" â€¢ "+e.duration+'</p><p class="playlist__episode-description">'+e.excerpt+'</p></div><audio preload="none" class="clip clip-'+e.episode_id+'"><source src="'+e.audio_file+'"></audio></li>',t.firstChild}(e);L.appendChild(t),t.addEventListener("click",Z)}):E.removeEventListener("scroll",$)}s()},e.onerror=function(){s()},e.send()}()}P&&P.addEventListener("click",function(){return V(j)}),J&&J.addEventListener("click",function(){return V(j)}),N&&N.addEventListener("click",function(){return V(X)}),B&&B.addEventListener("click",function(){return V(X)}),U&&U.addEventListener("click",function(){return Y(G)}),z&&z.addEventListener("click",function(){return Y(W)}),Q&&Q.addEventListener("click",function(){return Y(I)}),document.addEventListener("keydown",e=>{if(document.activeElement.closest(".castos-player"))if("ArrowRight"===e.code)e.preventDefault(),s.currentTime+=30;else if("ArrowLeft"===e.code)e.preventDefault(),s.currentTime-=10;else if("Space"===e.code)e.preventDefault(),T();else if("m"===e.key||"M"===e.key)y.dispatchEvent(new Event("click")),y.focus();else if(e.shiftKey&&"Period"===e.code){let e=v.dataset.speed<2?parseFloat(v.dataset.speed)+.2:2;F(e.toFixed(1))}else if(e.shiftKey&&"Comma"===e.code){let e=.4<v.dataset.speed?parseFloat(v.dataset.speed)-.2:.4;F(e.toFixed(1))}else e.shiftKey&&"Digit0"===e.code&&F(1)}),S&&(q=E.querySelector(".loader"),function(){let e=L.querySelectorAll(".playlist__item");e&&e.forEach(function(e){e.addEventListener("click",Z)}),E&&E.addEventListener("scroll",$)}()),O()})});